# ğŸš— DriveLens
### Edge-to-Cloud ç‰©ä½“èªè­˜ã‚·ã‚¹ãƒ†ãƒ 
*Edge-to-Cloud Object Recognition System for Dashcam*

---

## ğŸ“ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ã‚¨ãƒƒã‚¸ãƒ‡ãƒã‚¤ã‚¹ (Windows)      â”‚        â”‚          ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒãƒ¼ (Docker)         â”‚
â”‚                                      â”‚        â”‚                                         â”‚
â”‚  ğŸ“· ã‚«ãƒ¡ãƒ© / å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«              â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚         â”‚                            â”‚        â”‚  â”‚  FastAPI  POST /upload            â”‚  â”‚
â”‚  OpenCV ãƒ•ãƒ¬ãƒ¼ãƒ å–å¾—                  â”‚        â”‚  â”‚         â”‚                         â”‚  â”‚
â”‚         â”‚ ãƒªã‚µã‚¤ã‚º (640Ã—480)          â”‚ HTTP   â”‚  â”‚  YOLOv8n ç‰©ä½“æ¤œå‡º                 â”‚  â”‚
â”‚         â”‚ JPEG ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ (å“è³ª 80)    â”‚â”€POSTâ”€â”€â–¶â”‚  â”‚         â”‚ ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹åº§æ¨™ â”‚  â”‚
â”‚         â”‚ std::async éåŒæœŸé€ä¿¡        â”‚        â”‚  â”‚  EasyOCR ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º             â”‚  â”‚
â”‚         â”‚                            â”‚â—€â”€JSONâ”€â”€â”‚  â”‚         â”‚ æ—¥æœ¬èªãƒ»è‹±èªå¯¾å¿œ           â”‚  â”‚
â”‚  ğŸ–¥ ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹æç”»          â”‚        â”‚  â”‚  SQLite  çµæœä¿å­˜                 â”‚  â”‚
â”‚     cv::imshow ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º        â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼:**  
`C++ (OpenCV)` â†’ `HTTP POST (cpr)` â†’ `Docker (FastAPI)` â†’ `YOLOv8 + EasyOCR` â†’ `JSON` â†’ `C++ æç”»`

---

## âœ¨ ä¸»ãªç‰¹å¾´

### âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
| æœ€é©åŒ– | å†…å®¹ |
|---|---|
| **ãƒªã‚µã‚¤ã‚º** | é€ä¿¡å‰ã« 640Ã—480 ã¸ç¸®å°ã—ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¸¯åŸŸã‚’å‰Šæ¸› |
| **JPEG åœ§ç¸®** | å“è³ª 80 ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æœ€å°åŒ– |
| **éåŒæœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰** | `std::async` ã«ã‚ˆã‚Šã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­ã‚‚ãƒ€ãƒƒã‚·ãƒ¥ã‚«ãƒ ã®æ˜ åƒãŒé€”åˆ‡ã‚Œãªã„ |

### ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é‡è¦–ã®ãƒ­ãƒ¼ã‚«ãƒ« AI
| é …ç›® | å†…å®¹ |
|---|---|
| **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œ** | YOLOv8ãƒ»EasyOCR ã¯ã™ã¹ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œ â€” å¤–éƒ¨ API ä¸è¦ |
| **ãƒ‡ãƒ¼ã‚¿éé€ä¿¡** | ç”»åƒã¯ã‚µãƒ¼ãƒãƒ¼ï¼ˆDocker ã‚³ãƒ³ãƒ†ãƒŠï¼‰ã®å¤–éƒ¨ã«å‡ºãªã„ |
| **CPU ã®ã¿** | GPU ãªã—ã§å‹•ä½œã€‚ä¸€èˆ¬çš„ãªãƒãƒ¼ãƒˆ PC ã§ã‚‚åˆ©ç”¨å¯èƒ½ |

---

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ | èª¬æ˜ |
|---|---|---|
| **ã‚¨ãƒƒã‚¸** | C++20 | ãƒ•ãƒ¬ãƒ¼ãƒ å–å¾—ãƒ»éåŒæœŸé€ä¿¡ãƒ»æç”» |
| **ã‚¨ãƒƒã‚¸** | OpenCV 4 | ã‚«ãƒ¡ãƒ©å…¥åŠ›ãƒ»ç”»åƒå‡¦ç† |
| **ã‚¨ãƒƒã‚¸** | cpr | HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (libcurl ãƒ©ãƒƒãƒ‘ãƒ¼) |
| **ã‚¨ãƒƒã‚¸** | nlohmann/json | JSON ãƒ‘ãƒ¼ã‚¹ |
| **ä¾å­˜ç®¡ç†** | vcpkg | C++ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç®¡ç† |
| **ãƒ“ãƒ«ãƒ‰** | CMake 3.10+ | ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ“ãƒ«ãƒ‰ |
| **ã‚µãƒ¼ãƒãƒ¼** | Python 3.10 | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨€èª |
| **ã‚µãƒ¼ãƒãƒ¼** | FastAPI + uvicorn | REST API ã‚µãƒ¼ãƒãƒ¼ |
| **AI** | YOLOv8n (Ultralytics) | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç‰©ä½“æ¤œå‡º (COCO 80 ã‚¯ãƒ©ã‚¹) |
| **AI** | EasyOCR | ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºï¼ˆæ—¥æœ¬èªãƒ»è‹±èªï¼‰ |
| **DB** | SQLite | æ¤œå‡ºçµæœã®æ°¸ç¶šåŒ– |
| **ã‚¤ãƒ³ãƒ•ãƒ©** | Docker / docker-compose | ã‚µãƒ¼ãƒãƒ¼ã®ã‚³ãƒ³ãƒ†ãƒŠåŒ– |

---

## ğŸš€ èµ·å‹•æ–¹æ³•

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰

Docker ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚Œã°ã€**ã‚³ãƒãƒ³ãƒ‰1è¡Œã§èµ·å‹•ã§ãã¾ã™ã€‚**

```bash
docker compose up --build
```

- åˆå›ãƒ“ãƒ«ãƒ‰æ™‚ã« YOLOv8nãƒ»EasyOCR ãƒ¢ãƒ‡ãƒ«ã‚’è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- `http://localhost:8000` ã§ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•
- 2å›ç›®ä»¥é™ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ©ç”¨ã—é«˜é€Ÿèµ·å‹•ï¼ˆæ•°ç§’ï¼‰

å‹•ä½œç¢ºèª:
```bash
curl http://localhost:8000/health
# â†’ {"status":"running"}
```

ã‚µãƒ¼ãƒãƒ¼åœæ­¢:
```bash
docker compose down
```

---

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆã‚¨ãƒƒã‚¸ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰

#### å‰ææ¡ä»¶

- [Visual Studio 2022+](https://visualstudio.microsoft.com/) (C++ ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰)
- [CMake 3.10+](https://cmake.org/)
- [vcpkg](https://vcpkg.io/) (`C:\vcpkg` ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿)

#### ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```powershell
vcpkg install opencv4:x64-windows cpr:x64-windows nlohmann-json:x64-windows
```

#### ãƒ“ãƒ«ãƒ‰

```powershell
git clone https://github.com/Mafufuyu/DriveLens.git
cd DriveLens

cmake --preset x64-debug
cmake --build out/build/x64-debug --config Debug
```

#### å®Ÿè¡Œ

```powershell
# Web ã‚«ãƒ¡ãƒ©ã§èµ·å‹•
.\out\build\x64-debug\DriveLens\Debug\DriveLens.exe

# å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã§èµ·å‹•
.\out\build\x64-debug\DriveLens\Debug\DriveLens.exe "C:\path\to\video.mp4"
```

> âš ï¸ **æ³¨æ„:** ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’å…ˆã«èµ·å‹•ã—ã¦ã‹ã‚‰ã‚¨ãƒƒã‚¸ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚  
> `ESC` ã‚­ãƒ¼ã§çµ‚äº†ã—ã¾ã™ã€‚

---

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
DriveLens/
â”œâ”€â”€ DriveLens/
â”‚   â”œâ”€â”€ DriveLens.cpp        # ã‚¨ãƒƒã‚¸ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœ¬ä½“
â”‚   â”œâ”€â”€ DriveLens.h          # ãƒ˜ãƒƒãƒ€ãƒ¼
â”‚   â””â”€â”€ CMakeLists.txt
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ main.py              # FastAPI ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ocr.py               # YOLOv8 + EasyOCR ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ database.py          # SQLite CRUD
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ .dockerignore
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ CMakeLists.txt
â””â”€â”€ CMakePresets.json
```

---

## ğŸ” æ¤œå‡ºå¯¾è±¡ã‚¯ãƒ©ã‚¹

| ã‚¯ãƒ©ã‚¹ | æ—¥æœ¬èª |
|---|---|
| person | äºº |
| bicycle | è‡ªè»¢è»Š |
| car | è‡ªå‹•è»Š |
| motorcycle | ãƒã‚¤ã‚¯ |
| bus | ãƒã‚¹ |
| truck | ãƒˆãƒ©ãƒƒã‚¯ |
| traffic light | ä¿¡å·æ©Ÿ |
| stop sign | ä¸€æ™‚åœæ­¢æ¨™è­˜ |


